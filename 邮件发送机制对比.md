# 邮件发送机制对比

## 你提供的 HTML 网页的邮件发送方式

### 使用 `mailto:` 协议（客户端发送）

你提供的 HTML 网页**并不直接发送邮件**，而是使用 `mailto:` 协议打开用户的邮件客户端。

### 工作原理

1. **构建 mailto 链接**：
   ```javascript
   const mailto = `mailto:${CONTACT_EMAIL}?subject=${subject}&body=${body}`;
   ```

2. **打开邮件客户端**：
   - 用户点击按钮后，浏览器打开默认邮件客户端（如 Outlook、Mail.app、Gmail 等）
   - 邮件内容已预填（收件人、主题、正文）

3. **用户手动发送**：
   - 用户需要在邮件客户端中点击"发送"按钮
   - 邮件才真正发送出去

### 代码示例（来自你的 HTML）

```javascript
// 在 renderLeadForm() 函数中
const subject = encodeURIComponent("Request for Independent Electrical Risk Assessment");
const body = encodeURIComponent(`Hello,\n\nI've just completed...`);

// 存储 mailto 链接
state.draftMailto = `mailto:${CONTACT_EMAIL}?subject=${subject}&body=${body}`;

// 在成功页面显示链接
<a class="cta" id="sendEmailBtn" href="${state.draftMailto}">Send email to confirm →</a>
```

### 优点
- ✅ 不需要后端服务器
- ✅ 不需要 API Key 或邮件服务配置
- ✅ 用户可以看到邮件内容再确认发送
- ✅ 离线友好（只要有邮件客户端）

### 缺点
- ❌ 用户必须手动点击"发送"
- ❌ 依赖用户的邮件客户端配置
- ❌ 无法自动发送（需要用户操作）
- ❌ 无法追踪邮件是否真正发送
- ❌ 用户体验不够流畅

---

## 你的检查系统（当前项目）的邮件发送方式

### 使用 Resend API（服务器端自动发送）

你的检查系统使用 **Resend** 邮件服务，通过后端 API **自动发送邮件**。

### 工作原理

1. **用户提交检查**：
   - 前端调用 `/api/submitInspection`
   - 后端处理数据并生成报告

2. **后端自动发送邮件**：
   ```typescript
   // netlify/functions/lib/email.ts
   const resend = new Resend(apiKey);
   await resend.emails.send({
     from: "Electrical Inspection <reports@bhtechnology.com.au>",
     to: ["info@bhtechnology.com.au"],
     subject: "New Inspection Report: ...",
     html: emailHtml,
     text: emailText,
   });
   ```

3. **邮件自动发送**：
   - 无需用户操作
   - 邮件直接发送到收件箱

### 优点
- ✅ 完全自动化，无需用户操作
- ✅ 可以追踪发送状态
- ✅ 专业的邮件模板（HTML + 纯文本）
- ✅ 不依赖用户的邮件客户端
- ✅ 更好的用户体验

### 缺点
- ❌ 需要配置邮件服务（Resend API Key）
- ❌ 需要验证域名
- ❌ 需要后端服务器支持

---

## 对比总结

| 特性 | mailto: 方式（你的 HTML） | Resend API（你的检查系统） |
|------|-------------------------|---------------------------|
| **发送方式** | 打开邮件客户端，用户手动发送 | 后端自动发送 |
| **配置复杂度** | 无需配置 | 需要 API Key 和域名验证 |
| **用户体验** | 需要额外步骤 | 无缝自动发送 |
| **可靠性** | 依赖用户操作 | 自动化，更可靠 |
| **适用场景** | 简单的联系表单 | 自动化通知系统 |

---

## 建议

### 对于你的 HTML 网页

如果你想让它也自动发送邮件（而不是依赖用户手动发送），可以：

1. **添加后端 API**：
   - 创建一个 Netlify Function（类似 `/api/submitInspection`）
   - 使用 Resend 发送邮件

2. **修改前端代码**：
   ```javascript
   // 替换 mailto: 链接
   // 改为调用 API
   const response = await fetch('/api/sendLead', {
     method: 'POST',
     headers: { 'Content-Type': 'application/json' },
     body: JSON.stringify({ name, phone, email, notes, summary })
   });
   ```

3. **显示成功消息**：
   - 邮件发送成功后显示确认信息
   - 无需用户打开邮件客户端

### 对于你的检查系统

当前已经使用 Resend API，只需要：
1. 按照 `邮件配置详细步骤.md` 配置 Resend
2. 在 Netlify 设置环境变量
3. 重新部署

---

## 总结

- **你的 HTML 网页**：使用 `mailto:` 协议，需要用户手动发送邮件
- **你的检查系统**：使用 Resend API，自动发送邮件（需要配置）

如果你想让 HTML 网页也自动发送邮件，我可以帮你添加后端 API 支持。
