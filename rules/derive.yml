# Finding Derivation Rules
# Layer 1: Internal Dimensions (D1–D9) → Finding-level Signals
# See REPORT_OUTPUT_CONTRACT.md §0 for design principle: Finding ≠ Decision
#
# Internal dimensions (input):
#   D1 safety_impact         low|medium|high
#   D2 compliance_risk       none|minor|material
#   D3 failure_likelihood    low|medium|high
#   D4 urgency               now|short|planned
#   D5 degradation_trend     stable|worsening
#   D6 tenant_disruption_risk low|medium|high
#   D7 cost_volatility       stable|uncertain
#   D8 detectability         obvious|hidden
#   D9 decision_complexity   simple|requires_judgement

finding_derivation_rules:
  # Immediate Safety Risk: D1 = high AND D4 = now
  immediate_safety_risk:
    when:
      - safety_impact: high
      - urgency: now
    result: true

  # Sudden Failure Risk: D3 = high AND D8 = hidden
  sudden_failure_risk:
    when:
      - failure_likelihood: high
      - detectability: hidden
    result: true

  # Tenant Disruption Risk: D6 >= medium AND D3 >= medium
  tenant_disruption_risk:
    when:
      - tenant_disruption_risk: medium_or_above
      - failure_likelihood: medium_or_above
    result: true

  # Deferrable: can wait unless D4 = now OR D5 = worsening
  deferrable:
    unless:
      - urgency: now
      - degradation_trend: worsening
    result: true

  # Planning Value: D5 = worsening OR D7 = uncertain OR D9 = requires_judgement
  planning_value:
    when_any:
      - degradation_trend: worsening
      - cost_volatility: uncertain
      - decision_complexity: requires_judgement
    result: true
