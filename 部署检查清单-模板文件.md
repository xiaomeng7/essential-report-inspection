# éƒ¨ç½²æ£€æŸ¥æ¸…å• - æ¨¡æ¿æ–‡ä»¶

## âœ… å·²ä¿®å¤çš„é—®é¢˜

### é—®é¢˜ï¼šæ¨¡æ¿ä¸­æœªæ‰¾åˆ° {{REPORT_BODY_HTML}} å ä½ç¬¦

**åŸå› ï¼š**
- `report-template-md.docx` æ²¡æœ‰è¢«åŒ…å«åœ¨ Netlify éƒ¨ç½²é…ç½®ä¸­
- `netlify.toml` çš„ `included_files` åªåŒ…å«äº† `report-template.docx`

**è§£å†³æ–¹æ¡ˆï¼š**
1. âœ… åœ¨ `netlify.toml` ä¸­æ·»åŠ äº† `report-template-md.docx`
2. âœ… æ”¹è¿›äº†é”™è¯¯æç¤ºï¼Œæ˜¾ç¤ºæ¨¡æ¿æ–‡ä»¶å¤§å°
3. âœ… å¦‚æœæ‰¾ä¸åˆ° md æ¨¡æ¿ï¼Œç›´æ¥æŠ›å‡ºé”™è¯¯ï¼ˆä¸å†å›é€€åˆ°æ—§æ¨¡æ¿ï¼‰

## ğŸ“‹ éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

### 1. ç¡®ä¿æ¨¡æ¿æ–‡ä»¶å­˜åœ¨
```bash
# æ£€æŸ¥æ ¹ç›®å½•
ls -la report-template-md.docx

# æ£€æŸ¥ netlify/functions ç›®å½•
ls -la netlify/functions/report-template-md.docx
```

### 2. ç¡®ä¿æ„å»ºè„šæœ¬ä¼šå¤åˆ¶æ–‡ä»¶
```bash
# è¿è¡Œæ„å»ºè„šæœ¬
npm run copy-word-template-md

# éªŒè¯æ–‡ä»¶å·²å¤åˆ¶
ls -la netlify/functions/report-template-md.docx
```

### 3. æ£€æŸ¥ netlify.toml é…ç½®
ç¡®ä¿ `netlify.toml` çš„ `[functions].included_files` åŒ…å«ï¼š
```toml
"./netlify/functions/report-template-md.docx"
```

### 4. éªŒè¯æ¨¡æ¿æ–‡ä»¶å†…å®¹
```bash
# æ£€æŸ¥æ¨¡æ¿æ˜¯å¦åŒ…å«å ä½ç¬¦
node -e "
const PizZip = require('pizzip');
const fs = require('fs');
const zip = new PizZip(fs.readFileSync('netlify/functions/report-template-md.docx'));
const xml = zip.files['word/document.xml']?.asText() || '';
console.log('æ–‡ä»¶å¤§å°:', fs.statSync('netlify/functions/report-template-md.docx').size, 'bytes');
console.log('åŒ…å« REPORT_BODY_HTML:', xml.includes('REPORT_BODY_HTML'));
"
```

## ğŸ” å¦‚ä½•è¯†åˆ«æ­£ç¡®çš„æ¨¡æ¿

- **report-template-md.docx**ï¼ˆæ­£ç¡®ï¼‰ï¼šçº¦ 19078 bytesï¼ŒåŒ…å« `{{REPORT_BODY_HTML}}`
- **report-template.docx**ï¼ˆæ—§ç‰ˆï¼‰ï¼šçº¦ 111440 bytesï¼Œä¸åŒ…å« `{{REPORT_BODY_HTML}}`

## ğŸš€ éƒ¨ç½²æ­¥éª¤

1. **ç¡®ä¿æ–‡ä»¶å­˜åœ¨å¹¶æ­£ç¡®**
   ```bash
   npm run copy-word-template-md
   ```

2. **æäº¤å¹¶æ¨é€**
   ```bash
   git add netlify.toml netlify/functions/report-template-md.docx
   git commit -m "æ·»åŠ  report-template-md.docx åˆ°éƒ¨ç½²é…ç½®"
   git push
   ```

3. **ç­‰å¾… Netlify éƒ¨ç½²å®Œæˆ**

4. **æµ‹è¯•ç”ŸæˆæŠ¥å‘Š**
   - è®¿é—®ç”ŸæˆæŠ¥å‘Šçš„ API
   - æ£€æŸ¥æ—¥å¿—ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
     - `âœ… Found report-template-md.docx at: ...`
     - `âœ… Template contains {{REPORT_BODY_HTML}} placeholder`

## âš ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šä»ç„¶æ‰¾ä¸åˆ°æ¨¡æ¿æ–‡ä»¶

**æ£€æŸ¥ï¼š**
1. æ–‡ä»¶æ˜¯å¦åœ¨ `netlify/functions/` ç›®å½•ä¸­ï¼Ÿ
2. `netlify.toml` é…ç½®æ˜¯å¦æ­£ç¡®ï¼Ÿ
3. æ„å»ºæ—¥å¿—ä¸­æ˜¯å¦æœ‰å¤åˆ¶æ–‡ä»¶çš„è¾“å‡ºï¼Ÿ

**è§£å†³ï¼š**
```bash
# æ‰‹åŠ¨å¤åˆ¶æ–‡ä»¶
cp report-template-md.docx netlify/functions/report-template-md.docx

# é‡æ–°æ„å»º
npm run build

# é‡æ–°éƒ¨ç½²
git add netlify/functions/report-template-md.docx
git commit -m "ç¡®ä¿æ¨¡æ¿æ–‡ä»¶å­˜åœ¨"
git push
```

### é—®é¢˜ 2ï¼šæ¨¡æ¿æ–‡ä»¶å¤§å°ä¸å¯¹

å¦‚æœæ—¥å¿—æ˜¾ç¤ºæ¨¡æ¿æ–‡ä»¶å¤§å°çº¦ä¸º 111440 bytesï¼Œè¯´æ˜ä½¿ç”¨äº†æ—§çš„ `report-template.docx`ã€‚

**è§£å†³ï¼š**
1. æ£€æŸ¥ä»£ç æ˜¯å¦æ‰¾åˆ°äº† `report-template-md.docx`
2. æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
3. ç¡®ä¿ `netlify.toml` é…ç½®æ­£ç¡®

## ğŸ“ ç›¸å…³æ–‡ä»¶

- `netlify.toml` - Netlify éƒ¨ç½²é…ç½®
- `package.json` - æ„å»ºè„šæœ¬ï¼ˆcopy-word-template-mdï¼‰
- `netlify/functions/generateWordReport.ts` - æŠ¥å‘Šç”Ÿæˆé€»è¾‘
- `report-template-md.docx` - Markdown æ¨¡æ¿æ–‡ä»¶
